<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 For Teachers | teacheR</title>
  <meta name="description" content="Teach yourself or others R with this introduction to the fundamentals of the R language." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4 For Teachers | teacheR" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="cover.png" />
  <meta property="og:description" content="Teach yourself or others R with this introduction to the fundamentals of the R language." />
  <meta name="github-repo" content="ARawles/teacheR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 For Teachers | teacheR" />
  
  <meta name="twitter:description" content="Teach yourself or others R with this introduction to the fundamentals of the R language." />
  <meta name="twitter:image" content="cover.png" />

<meta name="author" content="Adam Rawles" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="for-students.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> teacheR (1<sup>st</sup> Edition)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.1.1</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i><b>1.2</b> About Me</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#why-teacher"><i class="fa fa-check"></i><b>1.3</b> Why teacheR?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#should-i-use-r"><i class="fa fa-check"></i><b>2.2</b> Should I use R?</a></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#using-r"><i class="fa fa-check"></i><b>2.3</b> Using R</a></li>
<li class="chapter" data-level="2.4" data-path="introduction.html"><a href="introduction.html#rstudio"><i class="fa fa-check"></i><b>2.4</b> RStudio</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction.html"><a href="introduction.html#what-is-an-ide"><i class="fa fa-check"></i><b>2.4.1</b> What is an IDE?</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction.html"><a href="introduction.html#using-rstudio"><i class="fa fa-check"></i><b>2.4.2</b> Using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>2.5</b> Packages</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction.html"><a href="introduction.html#installing-packages"><i class="fa fa-check"></i><b>2.5.1</b> Installing packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="for-students.html"><a href="for-students.html"><i class="fa fa-check"></i><b>3</b> For Students</a>
<ul>
<li class="chapter" data-level="3.1" data-path="for-students.html"><a href="for-students.html#operators"><i class="fa fa-check"></i><b>3.1</b> Operators</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="for-students.html"><a href="for-students.html#arithmetic-operators"><i class="fa fa-check"></i><b>3.1.1</b> Arithmetic operators</a></li>
<li class="chapter" data-level="3.1.2" data-path="for-students.html"><a href="for-students.html#logical-operators"><i class="fa fa-check"></i><b>3.1.2</b> Logical operators</a></li>
<li class="chapter" data-level="3.1.3" data-path="for-students.html"><a href="for-students.html#questions-operators"><i class="fa fa-check"></i><b>3.1.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="for-students.html"><a href="for-students.html#variable-assignment"><i class="fa fa-check"></i><b>3.2</b> Variable assignment</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="for-students.html"><a href="for-students.html#creating-variables"><i class="fa fa-check"></i><b>3.2.1</b> Creating variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="for-students.html"><a href="for-students.html#naming"><i class="fa fa-check"></i><b>3.2.2</b> Naming</a></li>
<li class="chapter" data-level="3.2.3" data-path="for-students.html"><a href="for-students.html#reassigning-variables"><i class="fa fa-check"></i><b>3.2.3</b> Reassigning variables</a></li>
<li class="chapter" data-level="3.2.4" data-path="for-students.html"><a href="for-students.html#questions-variable-assignment"><i class="fa fa-check"></i><b>3.2.4</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="for-students.html"><a href="for-students.html#data-types"><i class="fa fa-check"></i><b>3.3</b> Data types</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="for-students.html"><a href="for-students.html#logical"><i class="fa fa-check"></i><b>3.3.1</b> Logical</a></li>
<li class="chapter" data-level="3.3.2" data-path="for-students.html"><a href="for-students.html#double"><i class="fa fa-check"></i><b>3.3.2</b> Double</a></li>
<li class="chapter" data-level="3.3.3" data-path="for-students.html"><a href="for-students.html#integer"><i class="fa fa-check"></i><b>3.3.3</b> Integer</a></li>
<li class="chapter" data-level="3.3.4" data-path="for-students.html"><a href="for-students.html#character"><i class="fa fa-check"></i><b>3.3.4</b> Character</a></li>
<li class="chapter" data-level="3.3.5" data-path="for-students.html"><a href="for-students.html#factors"><i class="fa fa-check"></i><b>3.3.5</b> Factors</a></li>
<li class="chapter" data-level="3.3.6" data-path="for-students.html"><a href="for-students.html#dates"><i class="fa fa-check"></i><b>3.3.6</b> Dates</a></li>
<li class="chapter" data-level="3.3.7" data-path="for-students.html"><a href="for-students.html#datetimes-posixct"><i class="fa fa-check"></i><b>3.3.7</b> Datetimes (POSIXct)</a></li>
<li class="chapter" data-level="3.3.8" data-path="for-students.html"><a href="for-students.html#na-and-null"><i class="fa fa-check"></i><b>3.3.8</b> NA and NULL</a></li>
<li class="chapter" data-level="3.3.9" data-path="for-students.html"><a href="for-students.html#nan-and-infinity"><i class="fa fa-check"></i><b>3.3.9</b> NaN and Infinity</a></li>
<li class="chapter" data-level="3.3.10" data-path="for-students.html"><a href="for-students.html#implicit-conversion"><i class="fa fa-check"></i><b>3.3.10</b> Implicit Conversion</a></li>
<li class="chapter" data-level="3.3.11" data-path="for-students.html"><a href="for-students.html#questions-data-types"><i class="fa fa-check"></i><b>3.3.11</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="for-students.html"><a href="for-students.html#data-structures"><i class="fa fa-check"></i><b>3.4</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="for-students.html"><a href="for-students.html#vectors"><i class="fa fa-check"></i><b>3.4.1</b> Vectors</a></li>
<li class="chapter" data-level="3.4.2" data-path="for-students.html"><a href="for-students.html#lists"><i class="fa fa-check"></i><b>3.4.2</b> Lists</a></li>
<li class="chapter" data-level="3.4.3" data-path="for-students.html"><a href="for-students.html#lists-vs-vectors"><i class="fa fa-check"></i><b>3.4.3</b> Lists vs Vectors</a></li>
<li class="chapter" data-level="3.4.4" data-path="for-students.html"><a href="for-students.html#matrices"><i class="fa fa-check"></i><b>3.4.4</b> Matrices</a></li>
<li class="chapter" data-level="3.4.5" data-path="for-students.html"><a href="for-students.html#dataframes"><i class="fa fa-check"></i><b>3.4.5</b> Dataframes</a></li>
<li class="chapter" data-level="3.4.6" data-path="for-students.html"><a href="for-students.html#questions-data-structures"><i class="fa fa-check"></i><b>3.4.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="for-students.html"><a href="for-students.html#subsetting"><i class="fa fa-check"></i><b>3.5</b> Subsetting</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="for-students.html"><a href="for-students.html#vectors-1"><i class="fa fa-check"></i><b>3.5.1</b> Vectors</a></li>
<li class="chapter" data-level="3.5.2" data-path="for-students.html"><a href="for-students.html#lists-1"><i class="fa fa-check"></i><b>3.5.2</b> Lists</a></li>
<li class="chapter" data-level="3.5.3" data-path="for-students.html"><a href="for-students.html#matrices-1"><i class="fa fa-check"></i><b>3.5.3</b> Matrices</a></li>
<li class="chapter" data-level="3.5.4" data-path="for-students.html"><a href="for-students.html#dataframes-1"><i class="fa fa-check"></i><b>3.5.4</b> Dataframes</a></li>
<li class="chapter" data-level="3.5.5" data-path="for-students.html"><a href="for-students.html#subsetting-by-criteria"><i class="fa fa-check"></i><b>3.5.5</b> Subsetting by criteria</a></li>
<li class="chapter" data-level="3.5.6" data-path="for-students.html"><a href="for-students.html#questions-subsetting"><i class="fa fa-check"></i><b>3.5.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="for-students.html"><a href="for-students.html#functions"><i class="fa fa-check"></i><b>3.6</b> Functions</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="for-students.html"><a href="for-students.html#function-basics"><i class="fa fa-check"></i><b>3.6.1</b> Function basics</a></li>
<li class="chapter" data-level="3.6.2" data-path="for-students.html"><a href="for-students.html#questions-functions"><i class="fa fa-check"></i><b>3.6.2</b> Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="for-teachers.html"><a href="for-teachers.html"><i class="fa fa-check"></i><b>4</b> For Teachers</a>
<ul>
<li class="chapter" data-level="4.1" data-path="for-teachers.html"><a href="for-teachers.html#functions-teachers"><i class="fa fa-check"></i><b>4.1</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="for-teachers.html"><a href="for-teachers.html#creating-functions"><i class="fa fa-check"></i><b>4.1.1</b> Creating functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="for-teachers.html"><a href="for-teachers.html#input-validation"><i class="fa fa-check"></i><b>4.1.2</b> Input validation</a></li>
<li class="chapter" data-level="4.1.3" data-path="for-teachers.html"><a href="for-teachers.html#functions-as-objects"><i class="fa fa-check"></i><b>4.1.3</b> Functions as objects</a></li>
<li class="chapter" data-level="4.1.4" data-path="for-teachers.html"><a href="for-teachers.html#example-answer"><i class="fa fa-check"></i><b>4.1.4</b> Example answer</a></li>
<li class="chapter" data-level="4.1.5" data-path="for-teachers.html"><a href="for-teachers.html#vectorised-functions"><i class="fa fa-check"></i><b>4.1.5</b> Vectorised functions</a></li>
<li class="chapter" data-level="4.1.6" data-path="for-teachers.html"><a href="for-teachers.html#questions-functions-teachers"><i class="fa fa-check"></i><b>4.1.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="for-teachers.html"><a href="for-teachers.html#environments"><i class="fa fa-check"></i><b>4.2</b> Environments</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="for-teachers.html"><a href="for-teachers.html#environment-basics"><i class="fa fa-check"></i><b>4.2.1</b> Environment basics</a></li>
<li class="chapter" data-level="4.2.2" data-path="for-teachers.html"><a href="for-teachers.html#environment-inheritance"><i class="fa fa-check"></i><b>4.2.2</b> Environment inheritance</a></li>
<li class="chapter" data-level="4.2.3" data-path="for-teachers.html"><a href="for-teachers.html#scope"><i class="fa fa-check"></i><b>4.2.3</b> Scope</a></li>
<li class="chapter" data-level="4.2.4" data-path="for-teachers.html"><a href="for-teachers.html#function-environments"><i class="fa fa-check"></i><b>4.2.4</b> Function environments</a></li>
<li class="chapter" data-level="4.2.5" data-path="for-teachers.html"><a href="for-teachers.html#mutability"><i class="fa fa-check"></i><b>4.2.5</b> Mutability</a></li>
<li class="chapter" data-level="4.2.6" data-path="for-teachers.html"><a href="for-teachers.html#questions-environments"><i class="fa fa-check"></i><b>4.2.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="for-teachers.html"><a href="for-teachers.html#objects-and-classes"><i class="fa fa-check"></i><b>4.3</b> Objects and Classes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="for-teachers.html"><a href="for-teachers.html#what-is-a-class"><i class="fa fa-check"></i><b>4.3.1</b> What is a class?</a></li>
<li class="chapter" data-level="4.3.2" data-path="for-teachers.html"><a href="for-teachers.html#what-is-an-object"><i class="fa fa-check"></i><b>4.3.2</b> What is an object?</a></li>
<li class="chapter" data-level="4.3.3" data-path="for-teachers.html"><a href="for-teachers.html#objects-and-classes-in-r"><i class="fa fa-check"></i><b>4.3.3</b> Objects and Classes in R</a></li>
<li class="chapter" data-level="4.3.4" data-path="for-teachers.html"><a href="for-teachers.html#creating-classes"><i class="fa fa-check"></i><b>4.3.4</b> Creating classes</a></li>
<li class="chapter" data-level="4.3.5" data-path="for-teachers.html"><a href="for-teachers.html#questions-objects-and-classes"><i class="fa fa-check"></i><b>4.3.5</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="for-teachers.html"><a href="for-teachers.html#expressions"><i class="fa fa-check"></i><b>4.4</b> Expressions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="for-teachers.html"><a href="for-teachers.html#creating-expressions"><i class="fa fa-check"></i><b>4.4.1</b> Creating expressions</a></li>
<li class="chapter" data-level="4.4.2" data-path="for-teachers.html"><a href="for-teachers.html#evaluating-expressions"><i class="fa fa-check"></i><b>4.4.2</b> Evaluating expressions</a></li>
<li class="chapter" data-level="4.4.3" data-path="for-teachers.html"><a href="for-teachers.html#substitution"><i class="fa fa-check"></i><b>4.4.3</b> Substitution</a></li>
<li class="chapter" data-level="4.4.4" data-path="for-teachers.html"><a href="for-teachers.html#quasiquotation"><i class="fa fa-check"></i><b>4.4.4</b> Quasiquotation</a></li>
<li class="chapter" data-level="4.4.5" data-path="for-teachers.html"><a href="for-teachers.html#questions-expressions"><i class="fa fa-check"></i><b>4.4.5</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="for-teachers.html"><a href="for-teachers.html#if-else"><i class="fa fa-check"></i><b>4.5</b> If / Else</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="for-teachers.html"><a href="for-teachers.html#questions-if-else"><i class="fa fa-check"></i><b>4.5.1</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="for-teachers.html"><a href="for-teachers.html#iteration"><i class="fa fa-check"></i><b>4.6</b> Iteration</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="for-teachers.html"><a href="for-teachers.html#imperative-programming"><i class="fa fa-check"></i><b>4.6.1</b> Imperative programming</a></li>
<li class="chapter" data-level="4.6.2" data-path="for-teachers.html"><a href="for-teachers.html#for-loops"><i class="fa fa-check"></i><b>4.6.2</b> For loops</a></li>
<li class="chapter" data-level="4.6.3" data-path="for-teachers.html"><a href="for-teachers.html#while-loops"><i class="fa fa-check"></i><b>4.6.3</b> While loops</a></li>
<li class="chapter" data-level="4.6.4" data-path="for-teachers.html"><a href="for-teachers.html#functional-programming"><i class="fa fa-check"></i><b>4.6.4</b> Functional programming</a></li>
<li class="chapter" data-level="4.6.5" data-path="for-teachers.html"><a href="for-teachers.html#questions-iteration"><i class="fa fa-check"></i><b>4.6.5</b> Questions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>5</b> Summary</a>
<ul>
<li class="chapter" data-level="5.1" data-path="summary.html"><a href="summary.html#answers"><i class="fa fa-check"></i><b>5.1</b> Answers</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="summary.html"><a href="summary.html#for-students-1"><i class="fa fa-check"></i><b>5.1.1</b> For Students</a></li>
<li class="chapter" data-level="5.1.2" data-path="summary.html"><a href="summary.html#for-teachers-1"><i class="fa fa-check"></i><b>5.1.2</b> For Teachers</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="summary.html"><a href="summary.html#next-steps"><i class="fa fa-check"></i><b>5.2</b> Next Steps</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="summary.html"><a href="summary.html#operate"><i class="fa fa-check"></i><b>5.2.1</b> opeRate</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">teacheR</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="for-teachers" class="section level1" number="4">
<h1><span class="header-section-number">4</span> For Teachers</h1>
<p>Now we have a basic understanding of some of the core concepts in R, let’s have a look at them in a bit more detail. In contrast to the previous section, here were going to focus on the underpinnings of R. You can kind of think of this section as being less practical and more theoretical.</p>
<p>Previous experience in different programming language will definitely help you, but it’s not mandatory. We’re going to take a look at some core programming concepts in the next few sections, and the explanations here should be more than enough. If you do have experience in other languages, then these sections will hopefully outline some of the idiosyncrasies of R that make it different to other languages.</p>
<p>If you’re going to teach R, this section will provide you with a good level of understanding. Hopefully, you’ll not only know <em>how</em> to do something when asked, but <em>why</em> you should do it that way.</p>
<div id="functions-teachers" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Functions</h2>
<p>In the “For Students” section, we looked at what a function is and how to use one. In this section, we’re going to look more at the structure of a function and how you might go about writing your own functions.</p>
<p>When you start writing our own functions, you’ll start to see a massive improvement in your efficiency. By extracting out common tasks to functions and by keeping your functions simple, you can easily expand and debug your project. A rough rule of thumb is that if you’ve copied some code more than twice, think about extracting it out to a function.</p>
<p>Let’s take a look at an example of where it may be appropriate to shorten your workflow by using a function. Let’s say you’ve got 2 datasets, and you want to get the standard deviation and mean of one column and then create a normal distribution based on those values:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="for-teachers.html#cb232-1" aria-hidden="true" tabindex="-1"></a>dataset1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb232-2"><a href="for-teachers.html#cb232-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">observation_number =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</span>
<span id="cb232-3"><a href="for-teachers.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">35</span>,<span class="dv">13</span>,<span class="dv">20</span>,<span class="dv">40</span>)</span>
<span id="cb232-4"><a href="for-teachers.html#cb232-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb232-5"><a href="for-teachers.html#cb232-5" aria-hidden="true" tabindex="-1"></a>dataset2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb232-6"><a href="for-teachers.html#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">observation_number =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),</span>
<span id="cb232-7"><a href="for-teachers.html#cb232-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">income =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">600</span>,<span class="dv">900</span>)</span>
<span id="cb232-8"><a href="for-teachers.html#cb232-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Without using functions, our workflow might look like this:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="for-teachers.html#cb233-1" aria-hidden="true" tabindex="-1"></a>mean_ds1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataset1<span class="sc">$</span>value)</span>
<span id="cb233-2"><a href="for-teachers.html#cb233-2" aria-hidden="true" tabindex="-1"></a>sd_ds1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataset1<span class="sc">$</span>value)</span>
<span id="cb233-3"><a href="for-teachers.html#cb233-3" aria-hidden="true" tabindex="-1"></a>normal_dist_ds1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> mean_ds1, <span class="at">sd =</span> sd_ds1)</span>
<span id="cb233-4"><a href="for-teachers.html#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="for-teachers.html#cb233-5" aria-hidden="true" tabindex="-1"></a>mean_ds2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataset2<span class="sc">$</span>income)</span>
<span id="cb233-6"><a href="for-teachers.html#cb233-6" aria-hidden="true" tabindex="-1"></a>sd_ds2 <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataset2<span class="sc">$</span>income)</span>
<span id="cb233-7"><a href="for-teachers.html#cb233-7" aria-hidden="true" tabindex="-1"></a>normal_dist_ds2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> mean_ds2, <span class="at">sd =</span> sd_ds2)</span></code></pre></div>
<p>This isn’t too bad, but what if we wanted to add another dataset? We’d have to copy and paste the code yet again. Then, say we wanted not to use the mean but the median, we’d have to replace each call to the <code>mean()</code> function with <code>median()</code> in each block of code.</p>
<p>If we extract out the commonalities to a function, then not only do we reduce the amount of code we’re using, but this also makes future changes or fixes much easier.</p>
<p>We’ll look more specifically out how we create functions in the next few sections, but for now let’s imagine what we’d want our function to look like.
It’d need to calculate the mean and standard deviation of a column, but that column name or position in the dataframe might change - the column is called ‘value’ in the first dataset but is called ‘income’ in the second, and even though they’re both the second column in the dataset, we don’t want to rely on that in case we have a new dataset where the column we want to use isn’t in that position.</p>
<p>Let’s revisit this once we understand how we create functions in R a bit better. If you’re comfortable with creating functions in R, then you can skip to the <a href="for-teachers.html#example-answer">solution</a>.</p>
<div id="creating-functions" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Creating functions</h3>
<p>R and its packages give you access to hundreds of thousands of different functions, all tailored to perform a particular task. Despite this wide array to choose from however, they will always be cases where there isn’t a function to do exactly what you need to do. For those of you coming over from Excel, this can often be a serious source of frustration where there isn’t an Excel function for you to use and there isn’t an easy way to create one without knowing VBA.</p>
<p>R is different. Creating functions can be very simple and will really change the way you work.</p>
<p>Creating functions will also highlight an important delineation. Previously, we’ve been focusing on <em>calling</em> functions. Calling a function is essentially using it. But in order to call a function, it needs to be <em>defined</em>. Base functions are already defined (i.e. someone has already written what the function is going to do), but when you’re creating your own functions, you are <em>defining</em> a new function that you’re presumably going to call later on.</p>
<div id="function-structure" class="section level4" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Function structure</h4>
<p>If we go back to the beginning of this chapter, we learned that everything that exists is an object. Functions are no exception, and so we create them like we do all our other objects. There is a slight diversion however. When we define a function, we assign it to an object with the <code>function</code> keyword like this:</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="for-teachers.html#cb234-1" aria-hidden="true" tabindex="-1"></a>my_first_function <span class="ot">&lt;-</span> <span class="cf">function</span>() {}</span></code></pre></div>
<p>Notice how we’ve got two sets of brackets here. The first (<code>()</code>) is where we define our input parameters. The second (<code>{}</code>) is where we define the body of our function.</p>
<p>Let’s do a simple example. Let’s create a function that adds two numbers together:</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="for-teachers.html#cb235-1" aria-hidden="true" tabindex="-1"></a>my_sum_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb235-2"><a href="for-teachers.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb235-3"><a href="for-teachers.html#cb235-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So in this example, I’ve defined that when anyone uses the function, they need to provide two input parameters named <code>x</code> and <code>y</code>. Something that people tend to struggle with is that the names of your input parameters have no real <em>meaning</em>. They are just used to reference the value provided in the body of the function and, hopefully, make it clear what kind of thing the user of the function should be providing. This is why in some functions that require a dataframe there will be an input parameter called <code>df</code> or similar. It can suggest at a glance that the value required for that parameter is a data frame. But just calling it <code>df</code> alone has no impact.</p>
<p>In the body of the function, we can see that we’re just doing something really simple: we’re adding <code>x</code> and <code>y</code> together with <code>+</code>.</p>
<p>Once I’ve run the code to <strong>define</strong> my function, I can then <strong>call</strong> it like I would any other function:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="for-teachers.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">my_sum_function</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div id="optional-input-parameters-1" class="section level5" number="4.1.1.1.1">
<h5><span class="header-section-number">4.1.1.1.1</span> Optional input parameters</h5>
<p>When defining your function, you can define optional parameters. These will likely be values where most of the time you need it to be one thing, but there are edge cases where you need it to be something else. Defining optional parameters is really easy; whenever you define your function, just give it a value and that will be its default:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="for-teachers.html#cb238-1" aria-hidden="true" tabindex="-1"></a>add_mostly_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">y =</span> <span class="dv">2</span>){</span>
<span id="cb238-2"><a href="for-teachers.html#cb238-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb238-3"><a href="for-teachers.html#cb238-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb238-4"><a href="for-teachers.html#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="for-teachers.html#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="fu">add_mostly_2</span>(<span class="at">x =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="for-teachers.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add_mostly_2</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>Sometimes you’ll want to provide users with a set of options. To do so, provide a default value of a vector and use the <code>match.arg()</code> function like this:</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="for-teachers.html#cb242-1" aria-hidden="true" tabindex="-1"></a>greet_me <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">greeting =</span> <span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;welcome&quot;</span>)) {</span>
<span id="cb242-2"><a href="for-teachers.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  greeting <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(greeting)</span>
<span id="cb242-3"><a href="for-teachers.html#cb242-3" aria-hidden="true" tabindex="-1"></a>  greeting</span>
<span id="cb242-4"><a href="for-teachers.html#cb242-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This will ensure that users of the function can only provide one of the values in the vector. If they use the default, then the first value in the vector will be used:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="for-teachers.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">greet_me</span>(<span class="st">&quot;welcome&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;welcome&quot;</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="for-teachers.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">greet_me</span>()</span></code></pre></div>
<pre><code>## [1] &quot;hello&quot;</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="for-teachers.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">greet_me</span>(<span class="st">&quot;wassup&quot;</span>) <span class="co"># This will error because 1 wasn&#39;t an options for y</span></span></code></pre></div>
<pre><code>## Error in match.arg(greeting): &#39;arg&#39; should be one of &quot;hello&quot;, &quot;welcome&quot;</code></pre>
<p><strong>Note:</strong> The <code>match.arg()</code> function only works with character vectors.</p>
</div>
</div>
<div id="section" class="section level4" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> …</h4>
<p>You’ll notice a crucial distinction between R’s <code>sum()</code> function and ours. The base function allows for an indeterminate number of input parameters, whereas we’ve only allowed 2 (<code>x</code> and <code>y</code>). This is because the base <code>sum()</code> function uses a <code>...</code>. This <code>...</code> is essentially shorthand for “as many or as few inputs as the user wants to provide”. To use the <code>...</code>, just add it as in an input parameter:</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="for-teachers.html#cb249-1" aria-hidden="true" tabindex="-1"></a>dot_dot_dot_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, ...) {</span>
<span id="cb249-2"><a href="for-teachers.html#cb249-2" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The <code>...</code> works particularly well when you might be creating a function that <em>wraps</em> around another one. A wrapping function is just a function that makes a call to another one within it, like this:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="for-teachers.html#cb250-1" aria-hidden="true" tabindex="-1"></a>sum_and_add_2 <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb250-2"><a href="for-teachers.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(...) <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb250-3"><a href="for-teachers.html#cb250-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>All we’re basically doing in the above wrapping around the <code>sum()</code> function to add some specific functionality.</p>
<p>By using the <code>...</code> here, we can just pass everything that the user provides to the <code>sum()</code> function. This means we don’t have to worry about copying any input parameters.</p>
<div id="return-values" class="section level5" number="4.1.1.2.1">
<h5><span class="header-section-number">4.1.1.2.1</span> Return values</h5>
<p>As I mentioned in the “For Students” section, functions have a single return value. By default, a function will return the last evaluated object in the function environment. In our <code>my_sum_function</code> example, our last evaluation was <code>x + y</code>, so the output of that was what was returned by the function.</p>
<p>You can also be explicit with your return values by using the <code>return()</code> function. The <code>return()</code> function will return whatever is provided to the <code>return()</code> function. This can be useful if you want to return a value prematurely:</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="for-teachers.html#cb251-1" aria-hidden="true" tabindex="-1"></a>early_return_function <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y, <span class="at">return_x  =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb251-2"><a href="for-teachers.html#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (return_x) {</span>
<span id="cb251-3"><a href="for-teachers.html#cb251-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)</span>
<span id="cb251-4"><a href="for-teachers.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb251-5"><a href="for-teachers.html#cb251-5" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb251-6"><a href="for-teachers.html#cb251-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb251-7"><a href="for-teachers.html#cb251-7" aria-hidden="true" tabindex="-1"></a><span class="fu">early_return_function</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="dv">10</span>, <span class="at">return_x =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Here, we can see more clearly that <code>x</code> is returned when <code>return_x</code> is TRUE and <code>x + y</code> is returned otherwise.</p>
<p>Certain style guides suggest that you should <strong>only</strong> use <code>return()</code> statements for early returns. In other words, the “normal” return value for your function should be defined by what’s evaluated last. Personally, I think you should use whatever makes it clearer for you. I quite like seeing explicit <code>return()</code> values in a function because I find it makes it clearer what all the possible return values are, but this is just personal preference.</p>
</div>
</div>
</div>
<div id="input-validation" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Input validation</h3>
<p>Unlike some other languages, functions do not have a specific data type tied to each input parameter. Any requirements that are imposed on an input parameter (e.g. it should be numeric) are done by the function creator in the body of the function. So for instance, when you try to sum character strings, the error you get occurs because of type-checking in the body of the function, not when you provide the input parameters.</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="for-teachers.html#cb253-1" aria-hidden="true" tabindex="-1"></a>function_without_check <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb253-2"><a href="for-teachers.html#cb253-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb253-3"><a href="for-teachers.html#cb253-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb253-4"><a href="for-teachers.html#cb253-4" aria-hidden="true" tabindex="-1"></a><span class="fu">function_without_check</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="st">&quot;error for me please&quot;</span>)</span></code></pre></div>
<pre><code>## Error in x + y: non-numeric argument to binary operator</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="for-teachers.html#cb255-1" aria-hidden="true" tabindex="-1"></a>function_with_check <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb255-2"><a href="for-teachers.html#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {</span>
<span id="cb255-3"><a href="for-teachers.html#cb255-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">warning</span>(<span class="st">&quot;x or y isn&#39;t numeric. Returning NA&quot;</span>)</span>
<span id="cb255-4"><a href="for-teachers.html#cb255-4" aria-hidden="true" tabindex="-1"></a>    <span class="cn">NA_integer_</span></span>
<span id="cb255-5"><a href="for-teachers.html#cb255-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb255-6"><a href="for-teachers.html#cb255-6" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">+</span> y</span>
<span id="cb255-7"><a href="for-teachers.html#cb255-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb255-8"><a href="for-teachers.html#cb255-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb255-9"><a href="for-teachers.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="fu">function_with_check</span>(<span class="at">x =</span> <span class="dv">2</span>, <span class="at">y =</span> <span class="st">&quot;warn me please&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in function_with_check(x = 2, y = &quot;warn me please&quot;): x or y isn&#39;t
## numeric. Returning NA</code></pre>
<pre><code>## [1] NA</code></pre>
</div>
<div id="functions-as-objects" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Functions as objects</h3>
<p>Functions are technically just another object. This means that you can use functions like you would any other object. For instance, some functions will accept other functions as an input parameter. When we move onto the <code>apply</code> logic, the <code>lapply()</code> (list-apply) function requires a <code>FUN</code> parameter that is the function the be applied to each value in the provided list.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="for-teachers.html#cb258-1" aria-hidden="true" tabindex="-1"></a>sum_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb258-2"><a href="for-teachers.html#cb258-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb258-3"><a href="for-teachers.html#cb258-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>),</span>
<span id="cb258-4"><a href="for-teachers.html#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb258-5"><a href="for-teachers.html#cb258-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb258-6"><a href="for-teachers.html#cb258-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-7"><a href="for-teachers.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(sum_list, <span class="at">FUN =</span> sum)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 3
## 
## [[2]]
## [1] 15
## 
## [[3]]
## [1] 50</code></pre>
<p>Linked with the idea that functions are just another type of an object, there is an important distinction between
<code>substr</code>
and
<code>substr()</code>. The first will return the <code>substr</code> <em>object</em>. That is, not the result of applying inputs to the <code>substr</code> function, but the function itself. If you just type the name of the function into the console, it will show you the code for that function (it’s definition):</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="for-teachers.html#cb260-1" aria-hidden="true" tabindex="-1"></a>substr</span></code></pre></div>
<pre><code>## function (x, start, stop) 
## {
##     if (!is.character(x)) 
##         x &lt;- as.character(x)
##     .Internal(substr(x, as.integer(start), as.integer(stop)))
## }
## &lt;bytecode: 0x561d57e29590&gt;
## &lt;environment: namespace:base&gt;</code></pre>
<p>Conversely, <code>substr()</code> will <em>call</em> the <code>sum</code> function with the inputs provided in the brackets.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="for-teachers.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="st">&quot;hey there&quot;</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hey&quot;</code></pre>
<div id="anonymous-functions" class="section level4" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> Anonymous functions</h4>
<p>Because some functions accept functions as an argument, there is the concept of <strong>anonymous functions</strong> in R. These are just functions that haven’t been assigned a name. For example, we might want to use an anonymous function in an <code>lapply</code> call:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="for-teachers.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(sum_list, <span class="at">FUN =</span> <span class="cf">function</span>(x) <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 5
## 
## [[3]]
## [1] 10</code></pre>
<p>Anonymous functions mean that you don’t have to define your function in the traditional way. However, if you’re going to use that function more than once, it’s advisable to extract it out to a named function and then reference it:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="for-teachers.html#cb266-1" aria-hidden="true" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb266-2"><a href="for-teachers.html#cb266-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb266-3"><a href="for-teachers.html#cb266-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb266-4"><a href="for-teachers.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(sum_list, <span class="at">FUN =</span> diff)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1
## 
## [[2]]
## [1] 5
## 
## [[3]]
## [1] 10</code></pre>
</div>
</div>
<div id="example-answer" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Example answer</h3>
<p>Going back to our <a href="functions-teachers">previous example</a> of when we might want to make a function, what might our function actually look like? Recapping, we know we need to calculate the mean and standard deviation of a column, but that the name of the column might change. Using what we’ve just learnt, let’s have a go:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="for-teachers.html#cb268-1" aria-hidden="true" tabindex="-1"></a>create_norm_dist_from_column <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, column_name, <span class="at">n =</span> <span class="dv">1000</span>) {</span>
<span id="cb268-2"><a href="for-teachers.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  ds_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataset[[column_name]])</span>
<span id="cb268-3"><a href="for-teachers.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  ds_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataset[[column_name]])</span>
<span id="cb268-4"><a href="for-teachers.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnorm</span>(<span class="at">n =</span> n, <span class="at">mean =</span> ds_mean, <span class="at">sd =</span> ds_sd)</span>
<span id="cb268-5"><a href="for-teachers.html#cb268-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb268-6"><a href="for-teachers.html#cb268-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-7"><a href="for-teachers.html#cb268-7" aria-hidden="true" tabindex="-1"></a>normal_dist_ds1 <span class="ot">&lt;-</span> <span class="fu">create_norm_dist_from_column</span>(dataset1, <span class="st">&quot;value&quot;</span>)</span>
<span id="cb268-8"><a href="for-teachers.html#cb268-8" aria-hidden="true" tabindex="-1"></a>normal_dist_ds2 <span class="ot">&lt;-</span> <span class="fu">create_norm_dist_from_column</span>(dataset2, <span class="st">&quot;income&quot;</span>)</span>
<span id="cb268-9"><a href="for-teachers.html#cb268-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-10"><a href="for-teachers.html#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(normal_dist_ds1, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 24.326094 -2.005048 45.573227 -7.336614  6.023291</code></pre>
<p>Now, instead of copying the code each time we need it, we’ve extracted the common computations to a function and then we call the function where we need. Hopefully this demonstrates the logic behind why functions can be so useful.</p>
<p>This is an example of the concept of abstraction, which is a common theme in programming. If you’re interested in learning more about abstraction, the <a href="https://operate.arawles.co.uk">opeRate</a> book that I wrote to turn the understanding you’ve hopefully built up over this book into actual data analysis skills looks at abstraction in more detail.</p>
</div>
<div id="vectorised-functions" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Vectorised functions</h3>
<p>An important concept in R that differs from non-functional programming language is the presence of vectorised functions. Vectorised functions operate a bit like applying a set of values to a function over and over again without needing to use iterative loops (which we’ll look at later). For example, if we use the <code>substr()</code> function as an example, which creates a substring from a string, we can provide a vector of values to the <code>x</code> parameter instead of a single value and we’ll get a return value for each one:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="for-teachers.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;there&quot;</span>), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hell&quot; &quot;ther&quot;</code></pre>
<p>Logically, this is quite easy to wrap your head around. R has just applied the same parameters (<code>start = 1, stop = 4</code>) to two different strings. In fact, when you provide a single value, you’re still providing a vector, it just has a length of 1, so R just applies it once.</p>
<p>This makes repeating functions for multiple values much easier, because you don’t need to write any loops or <code>apply</code> statements.</p>
<div id="recycling" class="section level4" number="4.1.5.1">
<h4><span class="header-section-number">4.1.5.1</span> Recycling</h4>
<p>Things get a bit more complicated when you provide vectors to multiple arguments though. For example, what would happen if I provided <code>stop = c(4,3)</code> as a parameter to the above function call?</p>
<p>Make your guesses…</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="for-teachers.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;there&quot;</span>), <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] &quot;hell&quot; &quot;the&quot;</code></pre>
<p>R has used the first value in each vector for the first time it runs (<code>hello</code> and <code>4</code>), and then it’s used the second values from each vector when it runs the second time. What about the <code>start</code> parameter though? Well because it’s only got a length of 1 but the other parameters have a length of 2, the 1 gets <strong>recycled</strong> until it’s the same length as the other parameters. If the length of the larger vector isn’t a multiple of the smaller one, then the smaller vector is recycled until it’s the same length and any extra values are discarded. So the above example is the same as:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="for-teachers.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(<span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;there&quot;</span>), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">stop =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">3</span>))</span></code></pre></div>
<p>This idea of repeating an operation again and again is very common in programming, and it’s something that we’ll look at in more detail in the <a href="iteration">Iteration</a> chapter.</p>
</div>
</div>
<div id="questions-functions-teachers" class="section level3" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>How are <code>mean()</code> and <code>sum()</code> different in their implementation of <code>...</code>?</li>
<li>If functions are objects, how would you construct a function that returns a function? What might be a use for this?</li>
<li>What happens if you create a function that asks for an argument that is never used? Why isn’t there an error?
<ul>
<li>Hint: search ‘lazy’ evaluation</li>
</ul></li>
<li>What does the <code>missing()</code> function do? How does this go against the lazy approach?</li>
<li>Why might one use the <code>missing()</code> approach instead of assigning a default value? What are the drawbacks of this?</li>
</ol>
</div>
</div>
<div id="environments" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Environments</h2>
<p>As your scripts become more complex, the number of variables and functions that you assign will start to increase. Pair this with the fact that you may be using lots of external packages that will all contain lots of functions and the number of objects you’re working with can easily get into the hundreds and even thousands.</p>
<p>This presents a scoping issue: If I refer to the object <code>x</code>, what <code>x</code> do I mean if there’s more than one? In other words, in which scope should R search for the <code>x</code> object?</p>
<p>R uses environments to solve this issue. Environments are collections of objects that can be used to group similar objects and provides a replicable naming convention for retrieving objects that may have the same name from the appropriate environment.</p>
<p>In this chapter, we’re going to understand the concepts underpinning environments and scope in R.</p>
<div id="environment-basics" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Environment basics</h3>
<p>At its core, an environment is a collection of objects. A bit like a list, environments store multiple objects in a single structure.</p>
<p>To create a new environment, we use the <code>new.env()</code> function.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="for-teachers.html#cb275-1" aria-hidden="true" tabindex="-1"></a>new_env <span class="ot">&lt;-</span> <span class="fu">new.env</span>()</span></code></pre></div>
<p>To add items to our environment, we can add them like we would a list using the <code>$</code> operator:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="for-teachers.html#cb276-1" aria-hidden="true" tabindex="-1"></a>new_env<span class="sc">$</span>first_object <span class="ot">&lt;-</span> <span class="st">&quot;hello&quot;</span></span></code></pre></div>
<p>To list all of the objects in an environment, we use the <code>ls()</code> function:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="for-teachers.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(new_env)</span></code></pre></div>
<pre><code>## [1] &quot;first_object&quot;</code></pre>
<p>Importantly, you can’t have two objects in the same environment with the same name. If you try, you’ll just overwrite the previous value:</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="for-teachers.html#cb279-1" aria-hidden="true" tabindex="-1"></a>new_env<span class="sc">$</span>first_object <span class="ot">&lt;-</span> <span class="st">&quot;world&quot;</span></span>
<span id="cb279-2"><a href="for-teachers.html#cb279-2" aria-hidden="true" tabindex="-1"></a>new_env<span class="sc">$</span>first_object</span></code></pre></div>
<pre><code>## [1] &quot;world&quot;</code></pre>
</div>
<div id="environment-inheritance" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Environment inheritance</h3>
<p>Environments have parents and children. In other words, there is a hierarchy of environments, with environments being encapsulated in other environments while also encapsulated other environments.</p>
<p>Every environment (with the exception of what we call the empty environment) has a parent. For example, when I created my <code>new_env</code> environment before, this was created in the <strong>global environment</strong>. The global environment is the environment that objects are assigned to when working in R interactively. The global environment’s parent environment will be the environment of the last package you loaded. Packages have environments to avoid name conflicts with functions and to help R know where to look for a function. These package environments will contain everything that the package developer included with the package (i.e. functions, maybe some datasets, etc.).</p>
<p>At the top of the environments of packages you’ve loaded will be the <strong>base environment</strong> which is the environment of base R. Finally, the base environment’s parent is the <strong>empty environment</strong> which does not have a parent.</p>
<p>The hierarchy of these environments looks like this:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-111"></span>
<img src="diagrams/environments.png" alt="Environment hierarchy" width="50%" />
<p class="caption">
Figure 4.1: Environment hierarchy
</p>
</div>
</div>
<div id="scope" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Scope</h3>
<p>So we know that objects in the same environment can’t have the same name, but what happens when two different environments happen to have objects with the same name? This is where the concept of <strong>scope</strong> comes in. <strong>Scoping</strong> is the set of rules that governs where R will look for a value.</p>
<p>R will search for the object in order of environment, starting at the most specific environment (so the global environment in the above diagram) and moving up. For example, we know that there is a function in base R called <code>sum()</code>. But, if I define a new function in the global environment called <code>sum</code> then which function will be called when I type <code>sum(...)</code>. Well, because we know that the search path starts from the most specific environment, R will look for <code>sum</code> in the global environment first and it’ll find the <code>sum</code> that I’ve just defined. At this point, it’ll stop looking because <code>sum</code> has been found.</p>
<p>For this reason, it’s a good idea to use a package like <code>conflicted</code> to manage the packages you loaded, otherwise which function you use when you have two functions with the same name from different packages will be defined by which one you loaded later.</p>
<p>Alternatively, you can specific with which environment R should look for a particular function by prefixing the function with its package and <code>::</code>. For example, if I decided against my better judgement to define a function called <code>sum</code> in my environment, and then I wanted to call the base function, I could do so like this:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="for-teachers.html#cb281-1" aria-hidden="true" tabindex="-1"></a>base<span class="sc">::</span><span class="fu">sum</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
</div>
<div id="function-environments" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Function environments</h3>
<p>Functions, when they are called, create their own more specific environment. The parent of this environment will be the environment in which it was called (most often this will be the global environment).</p>
<p>This breeds some specific behaviours. For example, say you’ve written a function that expects two input parameters, <code>x</code> and <code>y</code>. Well, what would happen if someone had already defined an <code>x</code> and <code>y</code> variable in their script? Which value should R use?</p>
<p>Let’s see what happens.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="for-teachers.html#cb283-1" aria-hidden="true" tabindex="-1"></a>sum_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb283-2"><a href="for-teachers.html#cb283-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb283-3"><a href="for-teachers.html#cb283-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb283-4"><a href="for-teachers.html#cb283-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-5"><a href="for-teachers.html#cb283-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb283-6"><a href="for-teachers.html#cb283-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb283-7"><a href="for-teachers.html#cb283-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-8"><a href="for-teachers.html#cb283-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_custom</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>In this case, the fact that there is already an <code>x</code> and <code>y</code> in the global environment doesn’t really make much difference. The function creates its own more specific environment when it’s called, and it looks for the <code>x</code> and <code>y</code> variables in here first. It finds them and uses those values (1 and 2).</p>
<p>But what happens if a variable doesn’t exist in the more specific function environment? Let’s take a look.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="for-teachers.html#cb285-1" aria-hidden="true" tabindex="-1"></a>sum_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb285-2"><a href="for-teachers.html#cb285-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y <span class="sc">+</span> w</span>
<span id="cb285-3"><a href="for-teachers.html#cb285-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb285-4"><a href="for-teachers.html#cb285-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-5"><a href="for-teachers.html#cb285-5" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb285-6"><a href="for-teachers.html#cb285-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb285-7"><a href="for-teachers.html#cb285-7" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_custom</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<p>In this case, the function looks in the specific environment for <code>w</code>, but it doesn’t exist. The only objects that exist in the function environment are the <code>x</code> and <code>y</code> that we’ve provided. So when R doesn’t find it in the more specific environment, it looks in the less-specific global environment. It finds it, and so it uses the value it finds.</p>
<p>This can be a dangerous thing, so always make sure that you’re function is accessing the values you think it is.</p>
<p>So does R work the other way? Does it ever look in a more specific environment? Nope.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="for-teachers.html#cb287-1" aria-hidden="true" tabindex="-1"></a>sum_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb287-2"><a href="for-teachers.html#cb287-2" aria-hidden="true" tabindex="-1"></a>  im_a_sneaky_variable <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb287-3"><a href="for-teachers.html#cb287-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb287-4"><a href="for-teachers.html#cb287-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb287-5"><a href="for-teachers.html#cb287-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-6"><a href="for-teachers.html#cb287-6" aria-hidden="true" tabindex="-1"></a>im_a_sneaky_variable</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;im_a_sneaky_variable&#39; not found</code></pre>
<p>Once the function is called, objects in its environment are inaccessible. The long and short of it is, R will start from specific environments and then look upwards, never downwards.</p>
</div>
<div id="mutability" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Mutability</h3>
<p>Linked with the idea of function environments is mutability. An object is either mutable or immutable. If it is mutable, then it can be edited from within a function environment. If an object is immutable, then it can’t. This might seem like an arbitrary distinction, but it has important consequences. If an object is mutable, then calling the same function on that object twice in a row is going to provide different results (because the object will have changed after the first call). If an object is immutable, then calling the same function on the same object will always return the same value.</p>
<p>In R, values are immutable. In other words, when you pass an object to a function, that function operates on a <strong>copy</strong> of the object you provided - the object is not changed in place.</p>
<p>You can replace the value you passed to the function by assigning it to the returned value:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="for-teachers.html#cb289-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb289-2"><a href="for-teachers.html#cb289-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span></code></pre></div>
<p>But this hasn’t changed the original value of <code>x</code>. It’s actually just changed the binded value - you’ve created a new one and told <code>x</code> to be of that value now, you haven’t changed the original value.</p>
<p>For the most, this exact distinction isn’t too important. The important thing to remember is that when you pass an object to a function, <strong>you are operating on a copy of the object, not the original</strong>.</p>
<div id="super-assignment" class="section level4" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> ‘Super’ assignment</h4>
<p>There will be occasions, however, when you need to make changes to the global environment regardless of what environment you are currently in. For instance, say you want to increment a counter every time a function is called, regardless of where it’s called from. In these cases, you can use the <code>&lt;&lt;-</code> operator. This is used as an assignment operator to assign a value to the global environment. Observe…</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="for-teachers.html#cb290-1" aria-hidden="true" tabindex="-1"></a>sum_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y) {</span>
<span id="cb290-2"><a href="for-teachers.html#cb290-2" aria-hidden="true" tabindex="-1"></a>  count <span class="ot">&lt;&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb290-3"><a href="for-teachers.html#cb290-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> y</span>
<span id="cb290-4"><a href="for-teachers.html#cb290-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb290-5"><a href="for-teachers.html#cb290-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-6"><a href="for-teachers.html#cb290-6" aria-hidden="true" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb290-7"><a href="for-teachers.html#cb290-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-8"><a href="for-teachers.html#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_custom</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="for-teachers.html#cb292-1" aria-hidden="true" tabindex="-1"></a>count</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="for-teachers.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum_custom</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="for-teachers.html#cb296-1" aria-hidden="true" tabindex="-1"></a>count</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Note how when we assign <code>0</code> to our <code>count</code> variable outside of the function, we don’t need to use <code>&lt;&lt;-</code>. This is because we’re already assigning to the global environment.</p>
<p>Use the <code>&lt;&lt;-</code> with care and only assign something to the global environment if you really need to. Otherwise, you may start overwriting variables in your global environment without ever realising it.</p>
</div>
</div>
<div id="questions-environments" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>In what situations can we have two environments with the same name? Why is this?</li>
<li>Search ‘namespacing’. How does that concept relate to environments?
<ul>
<li>Hint: This is heavily related to question 1</li>
</ul></li>
<li>What might be an issue with create a function that uses superassignment on an object with the name <code>x</code>?</li>
</ol>
</div>
</div>
<div id="objects-and-classes" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Objects and Classes</h2>
<p>Objects and classes are a fairly ubiquitous concept across programming languages and data analysis tools. We’ll briefly look at what an object is in R, but by no means is this an exhaustive description.</p>
<div id="what-is-a-class" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> What is a class?</h3>
<p>The world is complicated. Everything in the world is unique and defined by an infinite number of properties and features. For example, if you take a person, they can be defined by their name, where they’re from, where their parents are from, their hair colour, their likes and dislikes, and so on and so on. When we want to store data in a structured and formal way in a computer system, however, this isn’t particularly helpful. Instead, we need to store data in a predefined structure. This is essentially what an class is; a pre-defined structure to store important attributes or features of a <strong>thing</strong>.</p>
<p>Let’s take the person instance again. Let’s say we’re going to store data on a number of individuals, we won’t be able to store everything about them. So we’ll choose a subset of their attributes or features to store that are relevant to what we need. But to make things more efficient, we’re going to store the same information for each one. So lets say we’re going to do some geographical analysis, we might want to include a person’s name, their nationality, and perhaps their ethnicity. So for each person we want to store, we can store these three attributes. And we might call this data structure a “person”. Well this is exactly what an class is; a collection of attributes and features that is shared objects instances of the same type.</p>
<p>So our class is “person”, and it has the attributes “name”, “nationality”, and “ethnicity”. Now this obviously doesn’t capture everything about a person, but it’s enough for what we want to do.</p>
<p>Graphing that object might look something like this:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-118"></span>
<img src="diagrams/objects.png" alt="Example `Person` object" width="50%" />
<p class="caption">
Figure 4.2: Example <code>Person</code> object
</p>
</div>
</div>
<div id="what-is-an-object" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> What is an object?</h3>
<p>An object is just an instance of a class. So if you create a person from our “person” called John, then “John” is the object an “person” is the class.</p>
<p>When you create a dataframe for example, you’re creating a <code>data.frame</code> object from the basic structure of the <code>data.frame</code> class.</p>
</div>
<div id="objects-and-classes-in-r" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Objects and Classes in R</h3>
<p>Looking more specifically at R, what kind of objects do we see. Well, according to John Chambers, the founder of the S programming language upon which R is based, everything is:</p>
<blockquote>
<p>"To understand computations in R, two slogans are helpful:</p>
<ul>
<li>Everything that exists is an object.</li>
<li>Everything that happens is a function call.</li>
</ul>
<p>— John Chambers"</p>
</blockquote>
<p>So every function, dataframe, plot, list, vector, integer, everything is an object.</p>
<p>To see the class of an object in R, use the <code>class()</code> function.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="for-teachers.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">data.frame</span>()) <span class="co"># here we&#39;re finding the class of an empty data.frame</span></span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="for-teachers.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data.frame) <span class="co"># here we&#39;re finding the class of the data.frame() function</span></span></code></pre></div>
<pre><code>## [1] &quot;function&quot;</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="for-teachers.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div id="inheritance" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Inheritance</h4>
<p>Sometimes, different classes are interrelated. For example, if you were storing data on vehicle, then you might have a “vehicle” class. But if you’re storing data on lots of different vehicles, you might also have classes for each type of vehicle (e.g. “car”, “motorbike”, etc.). All of these classes are still vehicles, and so you don’t want to have to repeat yourself when you define each of those classes. In other words, all of those classes are going to have some common attributes like colour, horsepower and so on. Similarly, each different type of vehicle will have some attributes that are unique to that type of vehicle. For instance, motorbikes can have sidecars but vans and cars don’t. Cars and vans have doors but motorbikes don’t. This highlights the benefits of inheritance. By creating a “vehicle” class and allowing your subsequent classes to inherit all of the attributes of the “vehicle” class, you can avoid duplication while allowing distinct classes. This way, when you want to add any attributes to all of your vehicles, you can just do it via the “vehicle” class rather than changing each type of vehicle class.</p>
<p>Diagramming this relationship:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-120"></span>
<img src="diagrams/inheritance_cars.png" alt="Example of inheritance using cars" width="50%" />
<p class="caption">
Figure 4.3: Example of inheritance using cars
</p>
</div>
<p>Inheritance is an extremely deep topic which we won’t go into here, but R objects also use inheritance. To see the inheritance tree of an object, use the <code>is()</code> function:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="for-teachers.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is</span>(1L)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;             &quot;double&quot;              &quot;numeric&quot;            
## [4] &quot;vector&quot;              &quot;data.frameRowLabels&quot;</code></pre>
<p>Diagramming this like our “vehicle” example would look like this:</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-122"></span>
<img src="diagrams/inheritance_numeric.png" alt="Inheritance of the integer class" width="50%" />
<p class="caption">
Figure 4.4: Inheritance of the integer class
</p>
</div>
<p>Here we can see that an integer object is made up of the integer, double, numeric classes. The order of inheritance goes from left to right so we know that the integer class inherits from the double class, which inherits from the numeric class.</p>
</div>
<div id="object-oriented-systems" class="section level4" number="4.3.3.2">
<h4><span class="header-section-number">4.3.3.2</span> Object-Oriented Systems</h4>
<p>Unfortunately (or fortunately, depending on your point of view), R doesn’t have a single way of storing objects. In fact, there are 2 object-oriented (OO) programming systems in base R, and more (like R6) can be added via packages. These two base OO systems are S3 and S4, and they differ in the way that objects are constructed, stored, and interacted with. We’re not going to go into the difference here, but I recommend Hadley’s <a href="https://adv-r.hadley.nz/">Advanced R</a> to better understand the difference between the two. For now, I’m just going to explain the basics of the S3 system as I think it’s the easiest to understand and helps convey the philosophy behind why we use objects more easily.</p>
<div id="s3" class="section level5" number="4.3.3.2.1">
<h5><span class="header-section-number">4.3.3.2.1</span> S3</h5>
<p>In the S3 system, we rely on generic functions and methods. Generics are functions that have a single common goal, but that can be used for objects that might be very different. For example, <code>print()</code>-ing a dataframe is going to be different to <code>print()</code>-ing a plot or an API response or whatever. But <code>print()</code> always seems to know what to do. The reason it does is that the <code>print()</code> function is a <strong>generic</strong> function that actually uses a more specific function to achieve it’s goal. In other words, we achieve a fairly high level goal like printing by calling a function that is specific to the object we’re working on under the hood. These more specific functions are called <strong>methods</strong>.</p>
<p>As a real world analogy, think of the process of talking to someone. The common goal in talking is to communicate. But, depending on the language that someone speaks, the actual act of talking is going to be slightly different for different people you talk to. In this case, you can think of <strong>communicating</strong> as being the <strong>generic</strong> - it’s the eventual goal. And <strong>talking in the appropriate language</strong> as being the <strong>method</strong>.</p>
<p>Going back to R, if you type <code>print.</code> into the console, the autocompleter will show you lots and lots of <code>print.something()</code> functions. These are all of the <strong>methods</strong> for all of the different printable objects in R. <code>print.date()</code> will print a date object, <code>print.data.frame()</code> will print a dataframe object and so on. But when you just use the <code>print()</code> function on an object, R will automatically choose which method it needs for the object you’ve passed as an input parameter. If there isn’t a specific method for the object you’ve provided, then it will use the default <code>print.default()</code> method.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="for-teachers.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here we&#39;re using the generic</span></span>
<span id="cb306-2"><a href="for-teachers.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2020/06/10&quot;</span>)) </span></code></pre></div>
<pre><code>## [1] &quot;2020-06-10&quot;</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="for-teachers.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because we&#39;re printing a Date object,</span></span>
<span id="cb308-2"><a href="for-teachers.html#cb308-2" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the method that is actually used</span></span>
<span id="cb308-3"><a href="for-teachers.html#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print.Date</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2020/06/10&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;2020-06-10&quot;</code></pre>
<p>If an object inherits multiple classes, then R will look for the correct method starting from it’s most specific class. So for example, if an object has classes <code>c("class_1", "class_2")</code>, then R would look for <code>print.class_1()</code> and only look for <code>print.class_2()</code> (and then <code>print.default()</code>) if it couldn’t find <code>print.class_1()</code>.</p>
<p>While you can often tell if something is an S3 method by it being a generic followed by a <code>.</code> and then an object name, don’t rely on this, because people often use <code>.</code> to separate words in functions that can make them look like S3 methods when they’re not.</p>
<p><strong>Note:</strong> In some languages, methods are essentially functions or sub-routines that are tied to an class. For instance, a class that represents a person’s bank account might have the method <code>Balance()</code>, which will return how much money a person has in their account. There are certainly some similarities between how methods are used in R and some other languages, they are a bit different. Mainly, in R, methods are not attributes of a class but are separate functions.</p>
</div>
</div>
</div>
<div id="creating-classes" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Creating classes</h3>
<p>The obvious question is “Can I make my own class in R?”. The answer is yes. And quite easily too. Whether you should or not is a different story. We’re just going to look very briefly at creating a class in using S3 for now, but I’d recommend Hadley’s <a href="http://adv-r.had.co.nz/">Advanced R</a> for a deeper look at the different systems and how to use them.</p>
<div id="class-attribute" class="section level4" number="4.3.4.1">
<h4><span class="header-section-number">4.3.4.1</span> Class attribute</h4>
<p>In S3, the class of an object is defined by its <code>class</code> attribute, which stores a vector of class names. To see an object’s class, we use the <code>class()</code> function:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="for-teachers.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="for-teachers.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(<span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<p>This class attribute will determine what method is dispatched when we call a generic on this object. So here, if we called <code>print()</code> on <code>1</code>, then it would look for <code>print.numeric()</code> and dispatch that method to print the object. Technically, this just calls <code>print.default()</code> because the default method knows how to print numeric values but the logic remains.</p>
<p>Something which will make OO programmers everywhere cringe, is that the class attribute for an R object is modifiable:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="for-teachers.html#cb314-1" aria-hidden="true" tabindex="-1"></a>var_1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb314-2"><a href="for-teachers.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_1) <span class="ot">&lt;-</span> <span class="st">&quot;custom_class&quot;</span></span>
<span id="cb314-3"><a href="for-teachers.html#cb314-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_1)</span></code></pre></div>
<pre><code>## [1] &quot;custom_class&quot;</code></pre>
<p>Now, when we attempt to print the <code>var_1</code> variable, R will look for the appropriate method based on it’s class (<code>custom_class</code>), which would be <code>print.custom_class()</code>. In this case, a <code>print.custom_class</code> method doesn’t exist, so it’ll default to the <code>print.default()</code> method:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="for-teachers.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_1)</span></code></pre></div>
<pre><code>## [1] 1
## attr(,&quot;class&quot;)
## [1] &quot;custom_class&quot;</code></pre>
<p>Importantly, we’ve learnt here that setting the class of an object is as easy as using the <code>class()</code> function and the <code>&lt;-</code> operator.</p>
</div>
<div id="constructor-functions" class="section level4" number="4.3.4.2">
<h4><span class="header-section-number">4.3.4.2</span> Constructor functions</h4>
<p>To ensure our objects in the same class all have a similar structure, we want to make a constructor function that requires certain values. For example, let’s create a class to store addresses, and we’ll say that we need the house name, the road and the city. Our constructor function might look like this:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="for-teachers.html#cb318-1" aria-hidden="true" tabindex="-1"></a>address <span class="ot">&lt;-</span> <span class="cf">function</span>(house_name, road, city) {</span>
<span id="cb318-2"><a href="for-teachers.html#cb318-2" aria-hidden="true" tabindex="-1"></a>  address <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb318-3"><a href="for-teachers.html#cb318-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">house_name =</span> house_name,</span>
<span id="cb318-4"><a href="for-teachers.html#cb318-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">road =</span> road,</span>
<span id="cb318-5"><a href="for-teachers.html#cb318-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">city =</span> city</span>
<span id="cb318-6"><a href="for-teachers.html#cb318-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb318-7"><a href="for-teachers.html#cb318-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(address) <span class="ot">&lt;-</span> <span class="st">&quot;address&quot;</span></span>
<span id="cb318-8"><a href="for-teachers.html#cb318-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(address)</span>
<span id="cb318-9"><a href="for-teachers.html#cb318-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now to create an object from my constructor function, I just need to use the <code>address()</code> function:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="for-teachers.html#cb319-1" aria-hidden="true" tabindex="-1"></a>my_address <span class="ot">&lt;-</span> <span class="fu">address</span>(<span class="st">&quot;4&quot;</span>, <span class="st">&quot;Pleasant Drive&quot;</span>, <span class="st">&quot;London&quot;</span>)</span>
<span id="cb319-2"><a href="for-teachers.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(my_address)</span></code></pre></div>
<pre><code>## [1] &quot;address&quot;</code></pre>
<p>Now, if I called <code>print(my_address)</code>, R would look for a <code>print.address()</code> method. But, it wouldn’t find one and so would turn to <code>print.default()</code> which would print our object like any other list. Therefore, we might want to write our own method to print our new object how we want to.</p>
</div>
<div id="creating-methods" class="section level4" number="4.3.4.3">
<h4><span class="header-section-number">4.3.4.3</span> Creating methods</h4>
<p>To create a method, all we need to do is create a function with the name of our generic followed by a ‘.’ and then name of our class. So from our previous example, our method would look like this:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="for-teachers.html#cb321-1" aria-hidden="true" tabindex="-1"></a>print.address <span class="ot">&lt;-</span> <span class="cf">function</span>(address) {</span>
<span id="cb321-2"><a href="for-teachers.html#cb321-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The house name is: &quot;</span>, address<span class="sc">$</span>house_name, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb321-3"><a href="for-teachers.html#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The road is: &quot;</span>, address<span class="sc">$</span>road, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb321-4"><a href="for-teachers.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;The city is: &quot;</span>, address<span class="sc">$</span>city, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb321-5"><a href="for-teachers.html#cb321-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now when we call <code>print()</code> on our new object, it will find the <code>print.address()</code> method and use that to print our object:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="for-teachers.html#cb322-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my_address)</span></code></pre></div>
<pre><code>## The house name is:  4 
## The road is:  Pleasant Drive 
## The city is:  London</code></pre>
</div>
<div id="creating-generics" class="section level4" number="4.3.4.4">
<h4><span class="header-section-number">4.3.4.4</span> Creating generics</h4>
<p>You can also create your own generic functions for your classes. Generic functions have a very simple structure. Let’s say we want to create a new generic called <code>post</code>:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="for-teachers.html#cb324-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb324-2"><a href="for-teachers.html#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">UseMethod</span>(<span class="st">&quot;post&quot;</span>)</span>
<span id="cb324-3"><a href="for-teachers.html#cb324-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This is just telling R that when the <code>post()</code> function is called on an object, look for the appropriate <code>post</code> method to use. Without us writing any methods, this would be useless because R wouldn’t have any methods to use!</p>
<p>Let’s create a default method that can be applied if we don’t have a more specific class:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="for-teachers.html#cb325-1" aria-hidden="true" tabindex="-1"></a>post.default <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb325-2"><a href="for-teachers.html#cb325-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Your object is now in the post! Expect it in 5 to 10 weeks&quot;</span>)</span>
<span id="cb325-3"><a href="for-teachers.html#cb325-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In our example, this default method isn’t going to be very useful but it demonstrates that we need a default method to be dispatched if we haven’t written a specific method for that object class.</p>
<p>Let’s write a method for our <code>address</code> object:</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="for-teachers.html#cb326-1" aria-hidden="true" tabindex="-1"></a>post.address <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb326-2"><a href="for-teachers.html#cb326-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Your object has been posted to &quot;</span>, x<span class="sc">$</span>house_name, <span class="st">&quot; &quot;</span>, x<span class="sc">$</span>road, <span class="st">&quot; &quot;</span>, x<span class="sc">$</span>city, <span class="st">&quot;!&quot;</span>)</span>
<span id="cb326-3"><a href="for-teachers.html#cb326-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, if we call our new generic on two different classes of object and compare:</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="for-teachers.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">post</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Your object is now in the post! Expect it in 5 to 10 weeks</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="for-teachers.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">post</span>(my_address)</span></code></pre></div>
<pre><code>## Your object has been posted to  4   Pleasant Drive   London !</code></pre>
<p>We can see that in the top example, <code>post()</code> has dispatched the <code>post.default()</code> method. In the second example though, it’s dispatched the <code>post.address()</code> method.</p>
<p>As you can see, the S3 system is quick and easy. For smaller projects, this should be more than enough to get you by. Because it’s quick and easy though, it’s not particularly sturdy. You can change the class of any object, which will change the methods that are called on it and so can really mess things up. If you’re careful though, creating custom objects in your projects can be very powerful.</p>
</div>
</div>
<div id="questions-objects-and-classes" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>Why does <code>is(1L)</code> return integer, then double, then numeric in that order?</li>
<li>Now we understand inheritance, why can dataframes be subsetted with a <code>$</code>?</li>
<li>If we create a dataframe and then call <code>print.default()</code> on it, why do we get the output that we do? Why does it look more like a list than a dataframe?</li>
<li>Why are constructors not a fool-proof way of making sure that all our objects of our class will have the same structure? How else might one create an object of class <code>address</code>?</li>
<li><code>methods("mean")</code> returns methods for dates and datetimes, but no other object. Why is this? What does this mean when constructing methods for a new generic?</li>
</ol>
</div>
</div>
<div id="expressions" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Expressions</h2>
<p>When we use R, we write code which is then passed to the console to be executed (evaluated). Before the code is executed though, it is just an <strong>expression</strong>.</p>
<p>An expression can therefore be defined as a section of R code that has not yet been fully evaluated. That does not mean that all expressions have to be <em>valid</em>. For example, a piece of code like this <code>mean()</code> is a valid expression, but will error when it is evaluated because <code>mean</code> is missing its required arguments.</p>
<p>Expressions themselves are made up of 4 constituent parts: calls, constants, names and pairlists. For now though, we’re not going to look at the bits that make up expressions, but instead we’ll focus on expressions as a whole.</p>
<div id="creating-expressions" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Creating expressions</h3>
<p>Creating an expression (an unevaluated piece of code) is done in base R using the <code>quote()</code> function. Unfortunately, the <code>expression()</code> function in R doesn’t actually create an expression in the sense we’re talking about, so use <code>quote()</code> instead.</p>
<p>When creating single line expressions, you can just provide the expression directly within the <code>quote()</code> function:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="for-teachers.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quote</span>(x <span class="sc">+</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## x + 10</code></pre>
<p>When providing multiple line expressions, wrap the argument in <code>{}</code> like this:</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="for-teachers.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quote</span>({</span>
<span id="cb333-2"><a href="for-teachers.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb333-3"><a href="for-teachers.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">-</span> <span class="dv">5</span></span>
<span id="cb333-4"><a href="for-teachers.html#cb333-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<pre><code>## {
##     x + 10
##     y - 5
## }</code></pre>
<p>Unfortunately, testing whether something is an expression in R isn’t that easy, because the base R functions are made for the constituent parts of the expression (e.g. <code>is.call()</code>, <code>is.name()</code>, etc.). Instead, you can use the <code>is_expression()</code> function from the <code>rlang</code> package to test whether something is an expression:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="for-teachers.html#cb335-1" aria-hidden="true" tabindex="-1"></a>rlang<span class="sc">::</span><span class="fu">is_expression</span>(</span>
<span id="cb335-2"><a href="for-teachers.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quote</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb335-3"><a href="for-teachers.html#cb335-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="evaluating-expressions" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Evaluating expressions</h3>
<p>Once you’ve created your expression, you can evaluate it using the <code>eval()</code> function:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="for-teachers.html#cb337-1" aria-hidden="true" tabindex="-1"></a>my_expr <span class="ot">&lt;-</span> <span class="fu">quote</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb337-2"><a href="for-teachers.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my_expr)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Of course in this example, this is essentially just the same as <code>1 + 1</code> as we’re evaluating the expression in the same environment in which it was created. However, the <code>eval()</code> function accepts an <code>envir</code> parameter where you can pass an environment for the expression to be evaluated in:</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="for-teachers.html#cb339-1" aria-hidden="true" tabindex="-1"></a>new_environ <span class="ot">&lt;-</span> <span class="fu">new.env</span>()</span>
<span id="cb339-2"><a href="for-teachers.html#cb339-2" aria-hidden="true" tabindex="-1"></a>new_environ<span class="sc">$</span>num <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb339-3"><a href="for-teachers.html#cb339-3" aria-hidden="true" tabindex="-1"></a>my_expr <span class="ot">&lt;-</span> <span class="fu">quote</span>(num <span class="sc">+</span> <span class="dv">5</span>)</span>
<span id="cb339-4"><a href="for-teachers.html#cb339-4" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my_expr) <span class="co"># this will error because num doesn&#39;t exist in our parent environment</span></span></code></pre></div>
<pre><code>## Error in eval(my_expr): object &#39;num&#39; not found</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="for-teachers.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(my_expr, new_environ) <span class="co"># this won&#39;t error because num exists in new_environ</span></span></code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>Using this, you can create expressions in one environment without evaluating them, and then evaluate them later in different environments to where they were created.</p>
</div>
<div id="substitution" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Substitution</h3>
<p>As well as hard coding in the objects and names in our expression, we can substitute in values from our environment. For example, lets say we wanted to create an <code>x &lt;- y + 1</code> expression, but we wanted to change what the value of <code>y</code> was when we created it. We could acheive this by using the <code>substitute()</code> function. <code>substitute()</code> requires two parameters, <code>expr</code> which must be an expression, and <code>env</code> which must be an environment or a list and contains the objects you want to substitute.</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="for-teachers.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">substitute</span>(x <span class="ot">&lt;-</span> y <span class="sc">+</span> <span class="dv">1</span>, <span class="fu">list</span>(<span class="at">y =</span> <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## x &lt;- 1 + 1</code></pre>
<p>As you can see, this doesn’t <em>evaluate</em> the expression, it simple substitutes the provided names with the values provided in the <code>env</code> parameter. This can be a really powerful tool for building up expressions.</p>
</div>
<div id="quasiquotation" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> Quasiquotation</h3>
<p>A related subject to expressions and substitution is the idea of <strong>quasiquotation</strong>, used heavily in the <code>tidyverse</code> packages. Quasiquotation is the process of quoting (creating expressions) and unquoting (evaluating) parts of that expression.</p>
<p>A good example of quasiquotation in action is the <code>dplyr</code> package. Within the <code>dplyr</code> package functions, you’ll provide column names to various analysis and data manipulation functions. When you provide those names however, you provide them as raw names (i.e. not in quotation marks): <code>dplyr::mutate(data, new_column = old_column + 1)</code>. Those column names are then quoted (as in <code>quote()</code>) and then evaluated in the context of the dataset that you’ve provided:</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="for-teachers.html#cb345-1" aria-hidden="true" tabindex="-1"></a>test_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col_1 =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb345-2"><a href="for-teachers.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">eval</span>(<span class="fu">quote</span>(col_1), <span class="at">env =</span> test_df)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<p>I won’t go into quasiquotation here because <a href="https://adv-r.hadley.nz/quasiquotation.html">Hadley’s chapters on the subject</a> in his Advanced R book summarises the topic much better than I ever could. But if you’re interested, I would recommend using the <code>tidyverse</code> packages and trying to understand how quoting and unquoting has been implemented in those packages. If you can get your head round it and even implement similar ideas in your own projects, you can greatly expand your flexibility and efficiency.</p>
</div>
<div id="questions-expressions" class="section level3" number="4.4.5">
<h3><span class="header-section-number">4.4.5</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>Why might an expression like this <code>fun(x)</code> be useful? Particularly, when paired with <code>substitute()</code>.</li>
<li>What’s the difference between</li>
</ol>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="for-teachers.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quote</span>({</span>
<span id="cb347-2"><a href="for-teachers.html#cb347-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb347-3"><a href="for-teachers.html#cb347-3" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb347-4"><a href="for-teachers.html#cb347-4" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="for-teachers.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb348-2"><a href="for-teachers.html#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quote</span>(x <span class="ot">&lt;-</span> <span class="dv">1</span>),</span>
<span id="cb348-3"><a href="for-teachers.html#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quote</span>(x <span class="sc">+</span> <span class="dv">10</span>)</span>
<span id="cb348-4"><a href="for-teachers.html#cb348-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Why do they evaluate to different things?</p>
</div>
</div>
<div id="if-else" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> If / Else</h2>
<p>Building on our logical operators, there will often be times where you want to split the logic of your code depending on a criteria. For example, if you’ve created a function that can accept a character string or a number, you might want to split the body of the function to do something slightly different depending on the class of the provided argument.</p>
<p>If / else statements in R has a simple structure:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="for-teachers.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (criteria_statement) {</span>
<span id="cb349-2"><a href="for-teachers.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  what_you_want_to_do</span>
<span id="cb349-3"><a href="for-teachers.html#cb349-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (other_criteria) {</span>
<span id="cb349-4"><a href="for-teachers.html#cb349-4" aria-hidden="true" tabindex="-1"></a>  something_else_you_want_to_do</span>
<span id="cb349-5"><a href="for-teachers.html#cb349-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb349-6"><a href="for-teachers.html#cb349-6" aria-hidden="true" tabindex="-1"></a>  something_you_want_to_do_if_all_else_fails</span>
<span id="cb349-7"><a href="for-teachers.html#cb349-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Putting this into practice, a real If / else block may look like this:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="for-teachers.html#cb350-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb350-2"><a href="for-teachers.html#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (x <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb350-3"><a href="for-teachers.html#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">&quot;x is 1&quot;</span>)</span>
<span id="cb350-4"><a href="for-teachers.html#cb350-4" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb350-5"><a href="for-teachers.html#cb350-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">&quot;x is 2&quot;</span>)</span>
<span id="cb350-6"><a href="for-teachers.html#cb350-6" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb350-7"><a href="for-teachers.html#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">&quot;x is not 1 or 2&quot;</span>)</span>
<span id="cb350-8"><a href="for-teachers.html#cb350-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;x is 1&quot;</code></pre>
<p>Implementing this in a function could look like this:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="for-teachers.html#cb352-1" aria-hidden="true" tabindex="-1"></a>what_is_it <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb352-2"><a href="for-teachers.html#cb352-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.character</span>(x)) {</span>
<span id="cb352-3"><a href="for-teachers.html#cb352-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;x is a character&quot;</span>)</span>
<span id="cb352-4"><a href="for-teachers.html#cb352-4" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) {</span>
<span id="cb352-5"><a href="for-teachers.html#cb352-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;x is numeric&quot;</span>)</span>
<span id="cb352-6"><a href="for-teachers.html#cb352-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb352-7"><a href="for-teachers.html#cb352-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;x is something else&quot;</span>)</span>
<span id="cb352-8"><a href="for-teachers.html#cb352-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb352-9"><a href="for-teachers.html#cb352-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb352-10"><a href="for-teachers.html#cb352-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-11"><a href="for-teachers.html#cb352-11" aria-hidden="true" tabindex="-1"></a><span class="fu">what_is_it</span>(<span class="st">&quot;hello&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;x is a character&quot;</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="for-teachers.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">what_is_it</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;x is numeric&quot;</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="for-teachers.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">what_is_it</span>(<span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] &quot;x is something else&quot;</code></pre>
<div id="questions-if-else" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>Rather than writing <code>if (x == 1 | x == 2 | x == 3)</code>, how could you use the <code>%in%</code> operator to make it shorter?</li>
<li>How does the <code>switch()</code> function relate to if / else statements?</li>
</ol>
</div>
</div>
<div id="iteration" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Iteration</h2>
<p>Functions are an important stepping stone in reducing the amount of code you need to do something (they make your code less <strong>verbose</strong>). Another tool in acheiving this goal is the idea of iteration. Iteration is just the process of doing something more than once.</p>
<p>We’ll often find ourselves doing the same thing again and again in programming. Calculating the means for lots of different columns, or different datasets, or making plots for different groups are all examples of operations that you’ll rarely only do once. There are two approaches to this: imperative programming and functional programming. First, we’ll take a look at imperative programming (for loops) as this is more akin to lots of other programming language. Later, however, we’ll look at how we can better utilise the fact that R is a functional programming to solve some iteration problems more easily and with fewer errors.</p>
<div id="imperative-programming" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Imperative programming</h3>
</div>
<div id="for-loops" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> For loops</h3>
<p>For loops are almost completely ubiquitous across different programming languages. They allow us to perform actions over a list or set of objects. They are flexible and explicit even if they can be difficult to understand. A simple for loop in R follows a simple structure:</p>
<pre><code>for (identifier in list) {
 do_something_with_it(identifier)
}</code></pre>
<p>In the above, the identifier is used to access the value that is currently being iterated upon. Let’s look at a practical example:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="for-teachers.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) {</span>
<span id="cb359-2"><a href="for-teachers.html#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb359-3"><a href="for-teachers.html#cb359-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2
## [1] 3</code></pre>
<p>In this loop, we go through the vector of values 1, 2 and 3, and we print it using the <code>i</code> identifier that we’ve assigned to the value we’re currently iterating upon. So the code inside the loop will run three times (once for each value in the vector we’ve provided). The first time, <code>i</code> will equal 1. The code will execute, and then <code>i</code> will take the value of 2 and so on.</p>
<p>This isn’t a particular useful example. Let’s look at more realistic example. Let’s say you’ve got a list with 2 dataframes in that have the same structure:</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="for-teachers.html#cb361-1" aria-hidden="true" tabindex="-1"></a>dataframe_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb361-2"><a href="for-teachers.html#cb361-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">data.frame</span>(</span>
<span id="cb361-3"><a href="for-teachers.html#cb361-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">obs =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb361-4"><a href="for-teachers.html#cb361-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">9</span>)</span>
<span id="cb361-5"><a href="for-teachers.html#cb361-5" aria-hidden="true" tabindex="-1"></a>                     ),</span>
<span id="cb361-6"><a href="for-teachers.html#cb361-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">data.frame</span>(</span>
<span id="cb361-7"><a href="for-teachers.html#cb361-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">obs =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),</span>
<span id="cb361-8"><a href="for-teachers.html#cb361-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">150</span>)</span>
<span id="cb361-9"><a href="for-teachers.html#cb361-9" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb361-10"><a href="for-teachers.html#cb361-10" aria-hidden="true" tabindex="-1"></a>                   )</span></code></pre></div>
<p>And you want to calculate the mean for the <code>value</code> column for each one:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="for-teachers.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> dataframe_list) {</span>
<span id="cb362-2"><a href="for-teachers.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(df<span class="sc">$</span>value)</span>
<span id="cb362-3"><a href="for-teachers.html#cb362-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Or, if we refer back to our <a href="for-teachers.html#example-answer">function example</a> from the Functions chapter, we could apply our function to each dataset to get a normal distribution for each. Rather than just printing those numbers, we’ll also construct a list to store the output:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="for-teachers.html#cb363-1" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb363-2"><a href="for-teachers.html#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (df <span class="cf">in</span> <span class="fu">seq_along</span>(dataframe_list)) {</span>
<span id="cb363-3"><a href="for-teachers.html#cb363-3" aria-hidden="true" tabindex="-1"></a>  output_list[[df]] <span class="ot">&lt;-</span> <span class="fu">create_norm_dist_from_column</span>(dataframe_list[[df]], <span class="st">&quot;value&quot;</span>)</span>
<span id="cb363-4"><a href="for-teachers.html#cb363-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb363-5"><a href="for-teachers.html#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(output_list[[<span class="dv">1</span>]], <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1]  9.048020  9.953176  9.021264  8.074338 10.911494</code></pre>
<p>In this case, rather than looping through the <em>values</em> in the <code>dataframe_list</code> list, we’re looping through the <em>indices</em> using <code>seq_along()</code>. <code>seq_along()</code> just creates a vector with all the indices in. So for a list with two values in it, this is <em>almost</em> equivalent to <code>1:2</code>.
Using the <code>seq_along()</code> approach lets us keep track of where we are in the <code>dataframe_list</code>, as we know exactly how many times the loop as run at any given time, so we can assign the output to the right position in <code>output_list</code>.</p>
<p><strong>Note:</strong> If you can avoid expanding a list (i.e. increasing the size of a list by one everytime to add to it), then this is preferable. However, for very small lists, expanding a list rather than pre-defining its size and filling those values isn’t really a big deal.</p>
</div>
<div id="while-loops" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> While loops</h3>
<p>While loops are closely related to for loops. Instead of looping through an object or through the indices of an object, a while loop runs when a criteria is fulfilled:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="for-teachers.html#cb365-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb365-2"><a href="for-teachers.html#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(x <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb365-3"><a href="for-teachers.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb365-4"><a href="for-teachers.html#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb365-5"><a href="for-teachers.html#cb365-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 1
## [1] 2</code></pre>
</div>
<div id="functional-programming" class="section level3" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Functional programming</h3>
<p>For loops and its derivatives are very powerful, but they are arguably less important in functional languages like R than they are in other languages like C and Python.</p>
<p>Instead, within R we can leverage functions to wrap the loops. For example, let’s look back at our <code>dataframe_list</code> example. We can turn our loop into a function that we can call whenever we have a list of dataframes:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="for-teachers.html#cb367-1" aria-hidden="true" tabindex="-1"></a>norm_dists <span class="ot">&lt;-</span> <span class="cf">function</span>(dfs, <span class="at">column =</span> <span class="st">&quot;value&quot;</span>) {</span>
<span id="cb367-2"><a href="for-teachers.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  output_list <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb367-3"><a href="for-teachers.html#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (df <span class="cf">in</span> <span class="fu">seq_along</span>(dfs)) {</span>
<span id="cb367-4"><a href="for-teachers.html#cb367-4" aria-hidden="true" tabindex="-1"></a>    output_list[[df]] <span class="ot">&lt;-</span> <span class="fu">create_norm_dist_from_column</span>(dfs[[df]], column)</span>
<span id="cb367-5"><a href="for-teachers.html#cb367-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb367-6"><a href="for-teachers.html#cb367-6" aria-hidden="true" tabindex="-1"></a>  output_list</span>
<span id="cb367-7"><a href="for-teachers.html#cb367-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb367-8"><a href="for-teachers.html#cb367-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-9"><a href="for-teachers.html#cb367-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb367-10"><a href="for-teachers.html#cb367-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">norm_dists</span>(dataframe_list)[[<span class="dv">1</span>]], <span class="dv">1</span></span>
<span id="cb367-11"><a href="for-teachers.html#cb367-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] 10.15947</code></pre>
<p>Now, whenever we have a list of dataframes we can just use our <code>norm_dists()</code> function and provide the column name to the <code>column</code> parameter. This is very closely related to the idea of vectorized functions, which we looked at the in <a href="for-teachers.html#vectorised-functions">Functions</a>. All vectorised functions will essentially wrap around a loop in same way or another.</p>
<div id="applying-functions" class="section level4" number="4.6.4.1">
<h4><span class="header-section-number">4.6.4.1</span> Applying functions</h4>
<p>Because of its importance in R, applying multiple values to the same function and keeping track of the output has bred its own functions and methodology. More specifically, it’s led to the development of the <code>apply</code> set of functions. These act as syntactic sugar to decrease the number of for loops present in your code*.</p>
<p>* A common argument is that <code>apply</code> functions are faster than for loops. Generally speaking, this is not true. Most times the function is just an implementation of a for loop at its core, meaning the <code>apply</code> functions aren’t more efficient or faster. Instead, the benefit comes from the readability and cleanliness of the code.</p>
<p>We’ve already seen an example of the <code>lapply</code> (list-apply) function in <a href="for-teachers.html#functions-as-objects">action</a>, but lets do another one. Let’s say we have a list of vectors containing numbers and we want the maximum for each.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="for-teachers.html#cb369-1" aria-hidden="true" tabindex="-1"></a>number_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb369-2"><a href="for-teachers.html#cb369-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb369-3"><a href="for-teachers.html#cb369-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="dv">500</span>,<span class="dv">250</span>,<span class="dv">100</span>,<span class="dv">10</span>),</span>
<span id="cb369-4"><a href="for-teachers.html#cb369-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="dv">1000</span>,<span class="dv">1001</span>,<span class="dv">1001</span>,<span class="dv">1000</span>)</span>
<span id="cb369-5"><a href="for-teachers.html#cb369-5" aria-hidden="true" tabindex="-1"></a>                )</span></code></pre></div>
<p>We can apply the <code>max()</code> function to each item in our list:</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="for-teachers.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(number_list, <span class="at">FUN =</span> max)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 4
## 
## [[2]]
## [1] 500
## 
## [[3]]
## [1] 1001</code></pre>
<p>As you can see, this is much shorter than writing out a for loop to acheive the same goal.</p>
<p>The <code>FUN</code> parameter accepts any function (including anonymous) functions, meaning that we can apply any function we like to each item in our list.</p>
</div>
<div id="purrr" class="section level4" number="4.6.4.2">
<h4><span class="header-section-number">4.6.4.2</span> purrr</h4>
<p>The <code>apply</code> family of functions in base R are extremely powerful. However, they are not quite as user-friendly as one might have hoped, and there are some inconsistencies across the different <code>apply</code> functions. To solve this, the <code>purrr</code> provides the <code>map()</code> functions to provide the same functionality but in a more succinct and universal way.</p>
<p>Personally, I do prefer the <code>purrr</code> functions to the base R functions as I find they’re easier to learn to use, however the base R functions do provide the same functionality. Documentation for the <code>purr</code> package can be found at <a href="purrr.tidyverse.org">https://purrr.tidyverse.org</a>.</p>
</div>
</div>
<div id="questions-iteration" class="section level3" number="4.6.5">
<h3><span class="header-section-number">4.6.5</span> Questions</h3>
<ol style="list-style-type: decimal">
<li>In what situation would you use <code>i in x</code> over <code>i in seq_along(x)</code>?</li>
<li>Why is <code>seq_along(x)</code> preferable to <code>1:length(x)</code>?</li>
<li>What would be the for loop code that would be required to replicate <code>lapply(number_list, FUN = max)</code>? Which would be easier to debug?</li>
</ol>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="for-students.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["teacheR.pdf", "PDF"], ["teacheR.mobi", "Kindle EBook"], ["teacheR.epub", "EPUB EBook"]],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
